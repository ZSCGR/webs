define("./chunk-070e2192.js",["exports","./chunk-539de822"],function(t,i){"use strict";function r(t,i,r,s){var e=t.createShader(r);if(!e)throw Error("Could not create shader");if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))throw new Error("Error compiling "+(r===t.VERTEX_SHADER?"vertex":"fragment")+" shader: "+t.getShaderInfoLog(e));t.attachShader(i,e)}var s={antialias:!0,alpha:!0,scaling:devicePixelRatio,timing:function(t){return t},uniforms:[],mesh:[{data:new Float32Array([-1,1,-1,-1,1,1,1,-1]),dimensions:2,name:"pos"}],indices:[0,1,2,2,1,3],clearColor:[1,0,0,1]},e={interpolation:"LINEAR"},o=function(){function t(t,e,o){var n,a,h,_,l;if(void 0===o&&(o={}),this._vertexShader=t,this._fragmentShader=e,this._uniformLocations=new Map,this._uniformValues=new Map,this._textures=new Map,this._vbos=new Map,this._opts=i.__assign({},s,o,{canvas:o.canvas||document.createElement("canvas")}),this._opts.uniforms=this._opts.uniforms.slice(),this.canvas=this._opts.canvas,this._gl=this.canvas.getContext("webgl",{antialias:this._opts.antialias,alpha:this._opts.alpha}),!this._gl)throw Error("No support for WebGL");var g=this._gl.createProgram();if(!g)throw Error("Could not create program");if(r(this._gl,g,this._gl.VERTEX_SHADER,this._vertexShader),r(this._gl,g,this._gl.FRAGMENT_SHADER,this._fragmentShader),this._gl.linkProgram(g),!this._gl.getProgramParameter(g,this._gl.LINK_STATUS))throw Error("Couldn’t link program: "+this._gl.getProgramInfoLog(g));if(this._gl.validateProgram(g),!this._gl.getProgramParameter(g,this._gl.VALIDATE_STATUS))throw Error("Couldn’t validate program: "+this._gl.getProgramInfoLog(g));this._gl.useProgram(g),this._opts.uniforms.push("iResolution");try{for(var f=i.__values(this._opts.uniforms),u=f.next();!u.done;u=f.next()){var c=u.value,m=this._gl.getUniformLocation(g,c);m?this._uniformLocations.set(c,m):console.error("Couldn’t find uniform location of "+c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(a=f.return)&&a.call(f)}finally{if(n)throw n.error}}try{for(var E=i.__values(this._opts.mesh),p=E.next();!p.done;p=E.next()){var T=p.value,d=this._gl.createBuffer();if(!d)throw Error("Could not create VBO");this._vbos.set(T.name,d),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,d),this._gl.bufferData(this._gl.ARRAY_BUFFER,T.data||new Float32Array([]),this._gl[T.usage||"STATIC_DRAW"]);var R=this._gl.getAttribLocation(g,T.name);this._gl.vertexAttribPointer(R,T.dimensions,this._gl.FLOAT,!1,0,0),this._gl.enableVertexAttribArray(R)}}catch(t){h={error:t}}finally{try{p&&!p.done&&(_=E.return)&&_.call(E)}finally{if(h)throw h.error}}var U=this._gl.createBuffer();this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,U),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(this._opts.indices),this._gl.STATIC_DRAW),(l=this._gl).clearColor.apply(l,i.__spread(this._opts.clearColor))}return t.prototype.updateVBO=function(t,i){this._assertVBOExists(t);var r=this._vbos.get(t);this._gl.bindBuffer(this._gl.ARRAY_BUFFER,r),this._gl.bufferData(this._gl.ARRAY_BUFFER,i,this._gl.STATIC_DRAW)},t.prototype.resize=function(){var t=this.canvas.getBoundingClientRect();this.canvas.width=t.width*this._opts.scaling,this.canvas.height=t.height*this._opts.scaling,this.setUniform2f("iResolution",[this.canvas.width,this.canvas.height]),this._gl.viewport(0,0,this.canvas.width,this.canvas.height)},t.prototype.hasUniform=function(t){return this._uniformLocations.has(t)},Object.defineProperty(t.prototype,"uniforms",{get:function(){return i.__spread(this._uniformLocations.keys())},enumerable:!0,configurable:!0}),t.prototype.getUniform=function(t){return this._assertUniformExists(t),this._uniformValues.get(t)},t.prototype.setUniform1i=function(t,i){this.hasUniform(t)&&(this._gl.uniform1i(this._getUniformLocation(t),i),this._uniformValues.set(t,[i]))},t.prototype.setUniform1f=function(t,i){this.hasUniform(t)&&(this._gl.uniform1f(this._getUniformLocation(t),i),this._uniformValues.set(t,[i]))},t.prototype.setUniform2f=function(t,i){this.hasUniform(t)&&(this._gl.uniform2fv(this._getUniformLocation(t),i),this._uniformValues.set(t,i))},t.prototype.setUniform3f=function(t,i){this.hasUniform(t)&&(this._gl.uniform3fv(this._getUniformLocation(t),i),this._uniformValues.set(t,i))},t.prototype.setUniform4f=function(t,i){this.hasUniform(t)&&(this._gl.uniform4fv(this._getUniformLocation(t),i),this._uniformValues.set(t,i))},t.prototype.draw=function(){this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.drawElements(this._gl.TRIANGLES,this._opts.indices.length,this._gl.UNSIGNED_SHORT,0)},t.prototype.getUniformNames=function(){return i.__spread(this._uniformLocations.keys())},t.prototype.activateTexture=function(t,i){if(!this._textures.has(t))throw Error("Unknown texture name");var r=this._textures.get(t);this._gl.activeTexture(this._gl["TEXTURE"+i]),this._gl.bindTexture(this._gl.TEXTURE_2D,r)},t.prototype.addTexture=function(t,r,s){void 0===s&&(s={});var o=i.__assign({},e,s);if(!this._textures.has(t)){var n=this._gl.createTexture();if(!n)throw Error("Could not create texture");this._textures.set(t,n)}var a=this._textures.get(t);this._gl.bindTexture(this._gl.TEXTURE_2D,a),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl[o.interpolation]),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl[o.interpolation]),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,this._gl.RGBA,this._gl.UNSIGNED_BYTE,r)},t.prototype._assertVBOExists=function(t){if(!this._vbos.has(t))throw Error("Unknown VBO "+t)},t.prototype._assertUniformExists=function(t){if(!this._uniformLocations.has(t))throw Error("Unknown uniform "+t)},t.prototype._getUniformLocation=function(t){return this._assertUniformExists(t),this._uniformLocations.get(t)},t}();t.ShaderBox=o});
//# sourceMappingURL=chunk-070e2192.js.map
